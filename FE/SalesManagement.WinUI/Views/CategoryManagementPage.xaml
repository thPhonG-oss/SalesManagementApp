<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="SalesManagement.WinUI.Views.CategoryManagementPage"
    x:Name="PageRoot"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <Grid Padding="24" Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- ===== HEADER ===== -->
        <!--<Grid Margin="0,0,0,16">
        <Grid.ColumnDefinitions>
        <ColumnDefinition Width="*"/>
        <ColumnDefinition Width="Auto"/>
        <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>

        <StackPanel>
        <TextBlock
        Text="Quáº£n lÃ½ danh má»¥c"
        FontSize="28"
        FontWeight="Bold"/>
        <TextBlock
        Text="Quáº£n lÃ½ cÃ¡c danh má»¥c sáº£n pháº©m"
        FontSize="14"
        Foreground="{ThemeResource TextFillColorSecondaryBrush}"
        Margin="0,4,0,0"/>
        </StackPanel>

        <Button
        Grid.Column="2"
        Content="ï¼‹ ThÃªm danh má»¥c"
        Height="36"
        Click="AddCategory_Click"/>
        </Grid>-->
        <!-- ===== HEADER ===== -->
        <Grid Margin="0,0,0,16">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <!-- Cá»™t cho nÃºt quay láº¡i -->
                <ColumnDefinition Width="*"/>
                <!-- Cá»™t cho tiÃªu Ä‘á» -->
                <ColumnDefinition Width="Auto"/>
                <!-- Cá»™t cho nÃºt thÃªm -->
            </Grid.ColumnDefinitions>

            <!-- NÃºt quay láº¡i -->
            <Button
                Grid.Column="0"
                Width="36"
                Height="36"
                Background="Transparent"
                BorderThickness="0"
                Click="BackButton_Click">
                <FontIcon Glyph="&#xE72B;" FontSize="16"/>
                <!-- â† icon back -->
            </Button>

            <!-- TiÃªu Ä‘á» -->
            <StackPanel Grid.Column="1" Margin="12,0,0,0">
                <TextBlock
                    Text="Quáº£n lÃ½ danh má»¥c"
                    FontSize="28"
                    FontWeight="Bold"/>
                <TextBlock
                    Text="Quáº£n lÃ½ cÃ¡c danh má»¥c sáº£n pháº©m"
                    FontSize="14"
                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                    Margin="0,4,0,0"/>
            </StackPanel>

            <!-- NÃºt thÃªm danh má»¥c -->
            <Button
                Grid.Column="2"
                Content="ï¼‹ ThÃªm danh má»¥c"
                Height="36"
                Click="AddCategory_Click"/>
        </Grid>


        <!-- ===== CONTENT ===== -->
        <Border
            Grid.Row="1"
            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
            CornerRadius="12"
            Padding="16"
            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
            BorderThickness="1">

            <Grid>
                <ProgressRing
                    IsActive="{Binding IsLoading}"
                    Width="50"
                    Height="50"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"/>

                <InfoBar
                    IsOpen="{Binding HasError}"
                    Severity="Error"
                    Title="Lá»—i"
                    Message="{Binding ErrorMessage}"
                    IsClosable="True"
                    VerticalAlignment="Top"
                    Margin="0,0,0,16"/>

                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Spacing="8" Visibility="{Binding ShowContent}">
                        <Border Background="{ThemeResource SubtleFillColorSecondaryBrush}" Padding="12" CornerRadius="8">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="2*"/>
                                    <ColumnDefinition Width="120"/>
                                    <ColumnDefinition Width="120"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock Text="TÃªn danh má»¥c" FontWeight="SemiBold"/>
                                <TextBlock Grid.Column="1" Text="MÃ´ táº£" FontWeight="SemiBold" Margin="12,0,0,0"/>
                                <TextBlock Grid.Column="3" Text="Thao tÃ¡c" FontWeight="SemiBold" Margin="12,0,0,0" TextAlignment="Center"/>
                            </Grid>
                        </Border>

                        <ItemsControl ItemsSource="{Binding Categories}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border
                                        Padding="12"
                                        Margin="0,4"
                                        CornerRadius="8"
                                        Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                        BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                        BorderThickness="1">

                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="2*"/>
                                                <ColumnDefinition Width="120"/>
                                                <ColumnDefinition Width="160"/>
                                            </Grid.ColumnDefinitions>

                                            <TextBlock
                                                Text="{Binding CategoryName}"
                                                FontSize="15"
                                                FontWeight="SemiBold"
                                                VerticalAlignment="Center"/>

                                            <TextBlock
                                                Grid.Column="1"
                                                Text="{Binding Description}"
                                                TextWrapping="Wrap"
                                                Margin="12,0,0,0"
                                                VerticalAlignment="Center"
                                                Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>

                                            <StackPanel
                                                Grid.Column="3"
                                                Orientation="Horizontal"
                                                Spacing="8"
                                                Margin="8,0"
                                                Padding="4,0"
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center">

                                                <!-- NÃºt Sá»­a -->
                                                <Button
                                                    Padding="16,0"
                                                    Height="32"
                                                    CornerRadius="6"
                                                    Background="#FF2196F3"
                                                    Foreground="White"
                                                    Click="EditCategory_Click">
                                                    <TextBlock Text="Sá»­a"/>
                                                </Button>


                                                <!-- NÃºt XÃ³a -->
                                                <Button
                                                    Padding="16,0"
                                                    Height="32"
                                                    CornerRadius="6"
                                                    Background="#FFE53935"
                                                    Foreground="White"
                                                    Command="{Binding DataContext.DeleteCategoryCommand, ElementName=PageRoot}"
                                                    CommandParameter="{Binding}">
                                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                                                        <TextBlock Text="XÃ³a"/>
                                                    </StackPanel>
                                                </Button>

                                            </StackPanel>



                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </StackPanel>
                </ScrollViewer>
            </Grid>
        </Border>

        <!-- ðŸ”¹ Popup thÃªm danh má»¥c -->
        <ContentDialog
            x:Name="AddCategoryDialog"
            Title="ThÃªm danh má»¥c má»›i"
            PrimaryButtonText="LÆ°u"
            CloseButtonText="Há»§y"
            DefaultButton="Primary"
            PrimaryButtonClick="AddCategoryDialog_PrimaryButtonClick"
            XamlRoot="{x:Bind XamlRoot}"
            Width="400">

            <StackPanel>
                <TextBox
                    Header="TÃªn danh má»¥c"
                    PlaceholderText="Nháº­p tÃªn danh má»¥c"
                    x:Name="CategoryNameTextBox"
                    Margin="0,4,0,12"/>

                <TextBox
                    Header="MÃ´ táº£"
                    PlaceholderText="Nháº­p mÃ´ táº£"
                    x:Name="DescriptionTextBox"
                    AcceptsReturn="True"
                    TextWrapping="Wrap"
                    Height="80"
                    Margin="0,4,0,12"/>

                <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Spacing="8">
                    <TextBlock Text="Hoáº¡t Ä‘á»™ng:" VerticalAlignment="Center"/>
                    <ToggleSwitch x:Name="IsActiveToggle" IsOn="True"/>
                </StackPanel>
            </StackPanel>
        </ContentDialog>
        <!-- ðŸ”¹ Popup chá»‰nh sá»­a danh má»¥c -->
        <ContentDialog
            x:Name="EditCategoryDialog"
            Title="Chá»‰nh sá»­a danh má»¥c"
            PrimaryButtonText="LÆ°u"
            CloseButtonText="Há»§y"
            DefaultButton="Primary"
            PrimaryButtonClick="EditCategoryDialog_PrimaryButtonClick"
            XamlRoot="{x:Bind XamlRoot}"
            Width="400">

            <StackPanel>
                <TextBox
                    Header="TÃªn danh má»¥c"
                    x:Name="EditCategoryNameTextBox"
                    Margin="0,4,0,12"/>

                <TextBox
                    Header="MÃ´ táº£"
                    x:Name="EditDescriptionTextBox"
                    AcceptsReturn="True"
                    TextWrapping="Wrap"
                    Height="80"
                    Margin="0,4,0,12"/>

                <StackPanel Orientation="Horizontal" Spacing="8">
                    <TextBlock Text="Hoáº¡t Ä‘á»™ng:" VerticalAlignment="Center"/>
                    <ToggleSwitch x:Name="EditIsActiveToggle"/>
                </StackPanel>
            </StackPanel>
        </ContentDialog>

    </Grid>
</Page>
