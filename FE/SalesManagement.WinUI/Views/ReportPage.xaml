<Page
    x:Class="SalesManagement.WinUI.Views.ReportPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:models="using:SalesManagement.WinUI.Models"
    xmlns:vm="using:SalesManagement.WinUI.ViewModels"
    xmlns:canvas="using:Microsoft.Graphics.Canvas.UI.Xaml"
    mc:Ignorable="d">

    <Grid>
        <ScrollViewer Padding="24">
            <StackPanel Spacing="20">

                <!-- Header & Filter Section -->
                <StackPanel Spacing="12">
                    <TextBlock
                        Text="Báo cáo thống kê sản phẩm và doanh thu"
                        Style="{StaticResource TitleTextBlockStyle}"
                        FontWeight="Bold" />

                    <StackPanel Orientation="Horizontal" Spacing="12">
                        <DatePicker
                            Header="Từ ngày"
                            Date="{x:Bind ViewModel.StartDate, Mode=TwoWay}"
                            MinWidth="180" />
                        <DatePicker
                            Header="Đến ngày"
                            Date="{x:Bind ViewModel.EndDate, Mode=TwoWay}"
                            MinWidth="180" />
                        <Button
                            Content="Load Báo cáo"
                            Click="OnLoadClick"
                            Style="{StaticResource AccentButtonStyle}"
                            VerticalAlignment="Bottom"
                            Padding="24,8" />
                    </StackPanel>
                </StackPanel>

                <!-- Loading Indicator -->
                <ProgressRing
                    IsActive="{x:Bind ViewModel.IsLoading, Mode=OneWay}"
                    Width="40"
                    Height="40"
                    HorizontalAlignment="Center" />


                <!-- ================= PRODUCT LINE CHART ================= -->
                <StackPanel Spacing="8">
                    <TextBlock
                        Text="📈 Xu hướng doanh số theo ngày"
                        Style="{StaticResource SubtitleTextBlockStyle}"
                        FontWeight="SemiBold" />
                    <canvas:CanvasControl
                        x:Name="ProductLineChart"
                        Height="600"
                        Draw="ProductLineChart_Draw"
                        ClearColor="White" />

                </StackPanel>



                <StackPanel Spacing="20">

                    <TextBlock Text="🥧 Doanh thu theo ngày (Top 7)" FontWeight="SemiBold"/>
                    <canvas:CanvasControl
                        x:Name="RevenueDayPie"
                        Height="320"
                        Draw="RevenueDayPie_Draw"
                        ClearColor="White"/>

                    <TextBlock Text="🥧 Doanh thu theo tháng" FontWeight="SemiBold"/>
                    <canvas:CanvasControl
                        x:Name="RevenueMonthPie"
                        Height="320"
                        Draw="RevenueMonthPie_Draw"
                        ClearColor="White"/>

                    <TextBlock Text="🥧 Doanh thu theo năm" FontWeight="SemiBold"/>
                    <canvas:CanvasControl
                        x:Name="RevenueYearPie"
                        Height="320"
                        Draw="RevenueYearPie_Draw"
                        ClearColor="White"/>

                </StackPanel>


            </StackPanel>

        </ScrollViewer>
    </Grid>
</Page>