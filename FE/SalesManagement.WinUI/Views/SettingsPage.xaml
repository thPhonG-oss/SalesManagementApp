<!-- FE/SalesManagement.WinUI/Views/SettingsPage.xaml -->
<Page
    x:Class="SalesManagement.WinUI.Views.SettingsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <Page.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <XamlControlsResources xmlns="using:Microsoft.UI.Xaml.Controls" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Page.Resources>

    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalAlignment="Stretch">
        <!-- Outer wrapper for centering -->
        <Grid HorizontalAlignment="Center" Width="{Binding ActualWidth, RelativeSource={RelativeSource Mode=TemplatedParent}}">
            <Grid MaxWidth="1200" HorizontalAlignment="Stretch" Padding="20">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- HEADER -->
                <StackPanel Grid.Row="0" Spacing="8" Margin="0,0,0,24">
                    <TextBlock Text="Cài đặt chương trình"
                               FontSize="28"
                               FontWeight="SemiBold"
                               TextWrapping="Wrap"/>
                    <TextBlock Text="Tùy chỉnh hiển thị và hành vi của ứng dụng"
                               Foreground="{ThemeResource SystemControlPageTextBaseMediumBrush}"
                               TextWrapping="Wrap"/>
                </StackPanel>

                <!-- STATUS MESSAGE -->
                <InfoBar Grid.Row="1"
                         Visibility="{x:Bind ViewModel.StatusMessage, Mode=OneWay, Converter={StaticResource StringNotEmptyToVisibilityConverter}}"
                         Message="{x:Bind ViewModel.StatusMessage, Mode=OneWay}"
                         Severity="Success"
                         Margin="0,0,0,16"
                         IsOpen="True"/>

                <!-- SETTINGS CONTENT -->
                <StackPanel Grid.Row="2" Spacing="16">

                    <!-- SECTION: HIỂN THỊ -->
                    <Border Background="{ThemeResource LayerFillColorDefaultBrush}"
                            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                            BorderThickness="1"
                            CornerRadius="8"
                            Padding="20">
                        <StackPanel Spacing="16">
                            <TextBlock Text="Hiển thị"
                                       FontSize="16"
                                       FontWeight="SemiBold"/>

                            <!-- Số lượng item mỗi trang -->
                            <Grid ColumnSpacing="20">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="140"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                    <TextBlock Text="Số lượng sản phẩm mỗi trang"
                                               FontWeight="Medium"
                                               TextWrapping="Wrap"/>
                                    <TextBlock Text="Số lượng sản phẩm hiển thị trong danh sách"
                                               FontSize="12"
                                               Foreground="{ThemeResource SystemControlPageTextBaseMediumBrush}"
                                               Margin="0,4,0,0"
                                               TextWrapping="Wrap"/>
                                </StackPanel>

                                <ComboBox Grid.Column="1"
                                          ItemsSource="{x:Bind ViewModel.PageSizeOptions}"
                                          SelectedItem="{x:Bind ViewModel.SelectedPageSize, Mode=TwoWay}"
                                          HorizontalAlignment="Stretch"/>
                            </Grid>

                            <Rectangle Height="1"
                                       Fill="{ThemeResource DividerStrokeColorDefaultBrush}"/>

                            <!-- Theme -->
                            <Grid ColumnSpacing="20">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="140"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                    <TextBlock Text="Giao diện"
                                               FontWeight="Medium"
                                               TextWrapping="Wrap"/>
                                    <TextBlock Text="Chọn chế độ sáng/tối cho ứng dụng"
                                               FontSize="12"
                                               Foreground="{ThemeResource SystemControlPageTextBaseMediumBrush}"
                                               Margin="0,4,0,0"
                                               TextWrapping="Wrap"/>
                                </StackPanel>

                                <ComboBox Grid.Column="1"
                                          ItemsSource="{x:Bind ViewModel.ThemeOptions}"
                                          SelectedItem="{x:Bind ViewModel.SelectedTheme, Mode=TwoWay}"
                                          HorizontalAlignment="Stretch"/>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- SECTION: HÀNH VI -->
                    <Border Background="{ThemeResource LayerFillColorDefaultBrush}"
                            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                            BorderThickness="1"
                            CornerRadius="8"
                            Padding="20">
                        <StackPanel Spacing="16">
                            <TextBlock Text="Hành vi"
                                       FontSize="16"
                                       FontWeight="SemiBold"/>

                            <!-- Nhớ màn hình cuối -->
                            <Grid ColumnSpacing="20">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                    <TextBlock Text="Nhớ màn hình cuối cùng"
                                               FontWeight="Medium"
                                               TextWrapping="Wrap"/>
                                    <TextBlock Text="Mở lại màn hình bạn đang làm việc khi khởi động"
                                               FontSize="12"
                                               Foreground="{ThemeResource SystemControlPageTextBaseMediumBrush}"
                                               Margin="0,4,0,0"
                                               TextWrapping="Wrap"/>
                                </StackPanel>

                                <ToggleSwitch Grid.Column="1"
                                              IsOn="{x:Bind ViewModel.RememberLastScreen, Mode=TwoWay}"
                                              OnContent=""
                                              OffContent=""
                                              HorizontalAlignment="Right"
                                              VerticalAlignment="Center"/>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- SECTION: THÔNG TIN -->
                    <Border Background="{ThemeResource LayerFillColorDefaultBrush}"
                            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                            BorderThickness="1"
                            CornerRadius="8"
                            Padding="20">
                        <StackPanel Spacing="8">
                            <TextBlock Text="Thông tin ứng dụng"
                                       FontSize="16"
                                       FontWeight="SemiBold"/>

                            <TextBlock Foreground="{ThemeResource SystemControlPageTextBaseMediumBrush}"
                                       TextWrapping="Wrap">
                                <Run Text="Phiên bản:"/>
                                <Run Text="1.0.0" FontWeight="SemiBold"/>
                            </TextBlock>

                            <TextBlock Foreground="{ThemeResource SystemControlPageTextBaseMediumBrush}"
                                       TextWrapping="Wrap">
                                <Run Text="Nhóm phát triển:"/>
                                <Run Text="Sales Management Team" FontWeight="SemiBold"/>
                            </TextBlock>
                        </StackPanel>
                    </Border>

                    <!-- SECTION: BẢO MẬT -->
                    <Border Background="{ThemeResource LayerFillColorDefaultBrush}"
                            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                            BorderThickness="1"
                            CornerRadius="8"
                            Padding="20">
                        <StackPanel Spacing="16">
                            <TextBlock Text="Bảo mật"
                                       FontSize="16"
                                       FontWeight="SemiBold"/>

                            <Grid ColumnSpacing="20">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Mật khẩu"
                                               FontWeight="Medium"/>
                                    <TextBlock Text="Thay đổi mật khẩu đăng nhập"
                                               FontSize="12"
                                               Foreground="{ThemeResource SystemControlPageTextBaseMediumBrush}"/>
                                </StackPanel>

                                <Button Grid.Column="1"
                                        Content="Thay đổi"
                                        Click="ChangePassword_Click"
                                        MinWidth="120"/>
                            </Grid>
                        </StackPanel>
                    </Border>

                </StackPanel>

                <!-- ACTION BUTTONS -->
                <Grid Grid.Row="3"
                      Margin="0,24,0,0"
                      ColumnSpacing="8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <Button Grid.Column="0"
                            Content="Hủy thay đổi"
                            Command="{x:Bind ViewModel.CancelCommand}"
                            IsEnabled="{x:Bind ViewModel.HasChanges, Mode=OneWay}"
                            MinWidth="140"/>

                    <Button Grid.Column="1"
                            Content="Khôi phục mặc định"
                            Command="{x:Bind ViewModel.ResetCommand}"
                            MinWidth="160"/>

                    <Grid Grid.Column="2"/>

                    <Button Grid.Column="3"
                            Content="Lưu cấu hình"
                            Command="{x:Bind ViewModel.SaveCommand}"
                            Style="{StaticResource AccentButtonStyle}"
                            IsEnabled="{x:Bind ViewModel.HasChanges, Mode=OneWay}"
                            MinWidth="140"/>
                </Grid>

            </Grid>
        </Grid>
    </ScrollViewer>
</Page>